<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Html 5 获取当前位置 DOM</title>
</head>
<body>
<div id="map" style="width:600px; height:400px"></div>
<div id="allmap" style="width:600px; height:400px"></div>
<script src="http://api.map.baidu.com/api?v=2.0"></script>
<script src="js/convertor.js"></script>
<script>
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(locationSuccess, locationError, {enableHighAccuracy: true});
    } else {
        alert("浏览器不支持html5来获取地理位置信息");
    }

    function locationSuccess(position){
        // 获取到当前位置经纬度  本例中是chrome浏览器取到的是google地图中的经纬度
        var coords = position.coords,
            lng = coords.longitude,
            lat = coords.latitude;
        console.log(lng + ' ' + lat)
        // 调用百度地图api显示
        var map = new BMap.Map("map"),    // 创建Map实例
            //point = new BMap.Point(lng,lat),
            p1 = new BMap.Point(lng,lat),
            p2 = new BMap.Point(121.523114,38.900),
            transit = new BMap.TransitRoute(map, {
                renderOptions: {map: map}
            });
        //map.centerAndZoom(point,12);
        map.enableScrollWheelZoom(true);
        transit.search(p1, p2);
    }

    function locationError(error){
        /*switch(error.code) {
            case error.TIMEOUT:
                showError("A timeout occured! Please try again!");
                break;
            case error.POSITION_UNAVAILABLE:
                showError('We can\'t detect your location. Sorry!');
                break;
            case error.PERMISSION_DENIED:
                showError('Please allow geolocation access for this to work.');
                break;
            case error.UNKNOWN_ERROR:
                showError('An unknown error occured!');
                break;
        }*/
    }
</script>
</body>
</html>